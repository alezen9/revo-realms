var lib={},types={},hasRequiredTypes;function requireTypes(){return hasRequiredTypes||(hasRequiredTypes=1,Object.defineProperty(types,"__esModule",{value:!0})),types}var ee={},taskCollection$1={},taskCollection={},utils$1={},hasRequiredUtils$1;function requireUtils$1(){if(hasRequiredUtils$1)return utils$1;hasRequiredUtils$1=1,Object.defineProperty(utils$1,"__esModule",{value:!0}),utils$1._fast_remove_single=void 0;function c(a,l){l!==-1&&(l===0?a.shift():l===a.length-1?a.length=a.length-1:a.splice(l,1))}return utils$1._fast_remove_single=c,utils$1}var bakeCollection={},hasRequiredBakeCollection;function requireBakeCollection(){return hasRequiredBakeCollection||(hasRequiredBakeCollection=1,function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.bakeCollectionVariadic=exports.bakeCollectionAwait=exports.bakeCollection=exports.BAKED_EMPTY_FUNC=void 0,exports.BAKED_EMPTY_FUNC=function(){};var FORLOOP_FALLBACK=1500;function generateArgsDefCode(c){var a="";if(c===0)return a;for(var l=0;l<c-1;++l)a+="arg"+String(l)+", ";return a+="arg"+String(c-1),a}function generateBodyPartsCode(c,a){for(var l="",u="",r=0;r<a;++r)l+="var f".concat(r," = collection[").concat(r,`];
`),u+="f".concat(r,"(").concat(c,`)
`);return{funcDefCode:l,funcCallCode:u}}function generateBodyPartsVariadicCode(c){for(var a="",l="",u=0;u<c;++u)a+="var f".concat(u," = collection[").concat(u,`];
`),l+="f".concat(u,`.apply(undefined, arguments)
`);return{funcDefCode:a,funcCallCode:l}}function bakeCollection(collection,fixedArgsNum){if(collection.length===0)return exports.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function(`).concat(argsDefCode,`) {
                `).concat(funcCallCode,`
            });
        })`)}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);collection.length%10===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 10) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                        collection[i+3](`).concat(argsDefCode,`);
                        collection[i+4](`).concat(argsDefCode,`);
                        collection[i+5](`).concat(argsDefCode,`);
                        collection[i+6](`).concat(argsDefCode,`);
                        collection[i+7](`).concat(argsDefCode,`);
                        collection[i+8](`).concat(argsDefCode,`);
                        collection[i+9](`).concat(argsDefCode,`);
                    }
                });
            })`):collection.length%4===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 4) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                        collection[i+3](`).concat(argsDefCode,`);
                    }
                });
            })`):collection.length%3===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 3) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                    }
                });
            })`):funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; ++i) {
                        collection[i](`).concat(argsDefCode,`);
                    }
                });
            })`)}{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports.bakeCollection=bakeCollection;function bakeCollectionAwait(collection,fixedArgsNum){if(collection.length===0)return exports.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function(`).concat(argsDefCode,`) {
                return Promise.all([ `).concat(funcCallCode,` ]);
            });
        })`)}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);funcFactoryCode=`(function(collection) {
            return (function(`.concat(argsDefCode,`) {
                var promises = Array(collection.length);
                for (var i = 0; i < collection.length; ++i) {
                    promises[i] = collection[i](`).concat(argsDefCode,`);
                }
                return Promise.all(promises);
            });
        })`)}{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports.bakeCollectionAwait=bakeCollectionAwait;function bakeCollectionVariadic(collection){if(collection.length===0)return exports.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var _a=generateBodyPartsVariadicCode(collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function() {
                `).concat(funcCallCode,`
            });
        })`)}else funcFactoryCode=`(function(collection) {
            return (function() {
                for (var i = 0; i < collection.length; ++i) {
                    collection[i].apply(undefined, arguments);
                }
            });
        })`;{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports.bakeCollectionVariadic=bakeCollectionVariadic}(bakeCollection)),bakeCollection}var hasRequiredTaskCollection$1;function requireTaskCollection$1(){if(hasRequiredTaskCollection$1)return taskCollection;hasRequiredTaskCollection$1=1;var c=taskCollection.__spreadArray||function(o,g,e){if(e||arguments.length===2)for(var t=0,n=g.length,i;t<n;t++)(i||!(t in g))&&(i||(i=Array.prototype.slice.call(g,0,t)),i[t]=g[t]);return o.concat(i||Array.prototype.slice.call(g))};Object.defineProperty(taskCollection,"__esModule",{value:!0}),taskCollection.TaskCollection=void 0;var a=requireUtils$1(),l=requireBakeCollection();function u(o,g){var e=this.length;if(e>1)if(g){var t;(t=this._tasks).push.apply(t,arguments),this.length+=arguments.length}else this._tasks.push(o),this.length++;else if(g){if(e===1){var n=Array(1+arguments.length);n.push(n),n.push.apply(n,arguments),this._tasks=n}else{var n=Array(arguments.length);n.push.apply(n,arguments),this._tasks=n}this.length+=arguments.length}else e===1?this._tasks=[this._tasks,o]:this._tasks=o,this.length++}function r(o,g){var e=this.length;if(e>1)if(g){var t;(t=this._tasks).push.apply(t,arguments),this.length+=arguments.length}else this._tasks.push(o),this.length++;else if(g){if(e===1){var n=Array(1+arguments.length);n.push(n),n.push.apply(n,arguments),this._tasks=n}else{var n=Array(arguments.length);n.push.apply(n,arguments),this._tasks=n}this.length+=arguments.length}else e===1?this._tasks=[this._tasks,o]:this._tasks=o,this.length++;this.firstEmitBuildStrategy?this.call=b:this.rebuild()}function h(o){this.length!==0&&(this.length===1?this._tasks===o&&(this.length=0):((0,a._fast_remove_single)(this._tasks,this._tasks.lastIndexOf(o)),this._tasks.length===1?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length))}function s(o){if(this.length!==0){if(this.length===1)if(this._tasks===o&&(this.length=0),this.firstEmitBuildStrategy){this.call=l.BAKED_EMPTY_FUNC;return}else{this.rebuild();return}else(0,a._fast_remove_single)(this._tasks,this._tasks.lastIndexOf(o)),this._tasks.length===1?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length;this.firstEmitBuildStrategy?this.call=b:this.rebuild()}}function _(o){for(var g,e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];this.length===0?(this._tasks=e,this.length=1):this.length===1?(e.unshift(this._tasks),this._tasks=e,this.length=this._tasks.length):((g=this._tasks).splice.apply(g,c([o,0],e,!1)),this.length=this._tasks.length)}function E(o){for(var g,e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];this.length===0?(this._tasks=e,this.length=1):this.length===1?(e.unshift(this._tasks),this._tasks=e,this.length=this._tasks.length):((g=this._tasks).splice.apply(g,c([o,0],e,!1)),this.length=this._tasks.length),this.firstEmitBuildStrategy?this.call=b:this.rebuild()}function A(){this.length===0?this.call=l.BAKED_EMPTY_FUNC:this.length===1?this.call=this._tasks:this.call=(0,l.bakeCollection)(this._tasks,this.argsNum)}function O(){this.length===0?this.call=l.BAKED_EMPTY_FUNC:this.length===1?this.call=this._tasks:this.call=(0,l.bakeCollectionAwait)(this._tasks,this.argsNum)}function b(){this.rebuild(),this.call.apply(void 0,arguments)}var C=function(){function o(g,e,t,n){e===void 0&&(e=!0),t===void 0&&(t=null),n===void 0&&(n=!1),this.awaitTasks=n,this.call=l.BAKED_EMPTY_FUNC,this.argsNum=g,this.firstEmitBuildStrategy=!0,n?this.rebuild=O.bind(this):this.rebuild=A.bind(this),this.setAutoRebuild(e),t?typeof t=="function"?(this._tasks=t,this.length=1):(this._tasks=t,this.length=t.length):(this._tasks=null,this.length=0),e&&this.rebuild()}return o}();taskCollection.TaskCollection=C;function F(){this._tasks=null,this.length=0,this.call=l.BAKED_EMPTY_FUNC}function q(){this._tasks=null,this.length=0,this.call=l.BAKED_EMPTY_FUNC}function B(o){this.argsNum<o&&(this.argsNum=o,this.firstEmitBuildStrategy?this.call=b:this.rebuild())}function D(o){o?(this.push=r.bind(this),this.insert=E.bind(this),this.removeLast=s.bind(this)):(this.push=u.bind(this),this.insert=_.bind(this),this.removeLast=h.bind(this))}function P(){return this.length===0?[]:this.length===1?[this._tasks]:this._tasks}function j(o){o.length===0?(this.length=0,this.call=l.BAKED_EMPTY_FUNC):o.length===1?(this.length=1,this.call=o[0],this._tasks=o[0]):(this.length=o.length,this._tasks=o,this.firstEmitBuildStrategy?this.call=b:this.rebuild())}return C.prototype.fastClear=F,C.prototype.clear=q,C.prototype.growArgsNum=B,C.prototype.setAutoRebuild=D,C.prototype.tasksAsArray=P,C.prototype.setTasks=j,taskCollection}var hasRequiredTaskCollection;function requireTaskCollection(){return hasRequiredTaskCollection||(hasRequiredTaskCollection=1,function(c){var a=taskCollection$1.__createBinding||(Object.create?function(u,r,h,s){s===void 0&&(s=h);var _=Object.getOwnPropertyDescriptor(r,h);(!_||("get"in _?!r.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return r[h]}}),Object.defineProperty(u,s,_)}:function(u,r,h,s){s===void 0&&(s=h),u[s]=r[h]}),l=taskCollection$1.__exportStar||function(u,r){for(var h in u)h!=="default"&&!Object.prototype.hasOwnProperty.call(r,h)&&a(r,u,h)};Object.defineProperty(c,"__esModule",{value:!0}),l(requireTaskCollection$1(),c)}(taskCollection$1)),taskCollection$1}var utils={},hasRequiredUtils;function requireUtils(){if(hasRequiredUtils)return utils;hasRequiredUtils=1,Object.defineProperty(utils,"__esModule",{value:!0}),utils.nullObj=void 0;function c(){var a={};return a.__proto__=null,a}return utils.nullObj=c,utils}var hasRequiredEe;function requireEe(){if(hasRequiredEe)return ee;hasRequiredEe=1;var c=ee.__spreadArray||function(e,t,n){if(n||arguments.length===2)for(var i=0,d=t.length,y;i<d;i++)(y||!(i in t))&&(y||(y=Array.prototype.slice.call(t,0,i)),y[i]=t[i]);return e.concat(y||Array.prototype.slice.call(t))};Object.defineProperty(ee,"__esModule",{value:!0}),ee.EventEmitter=void 0;var a=requireTaskCollection(),l=requireUtils$1(),u=requireUtils();function r(e,t,n,i,d,y){var p=this.events[e];if(p){if(p.length===0)return!1;if(p.argsNum<6)p.call(t,n,i,d,y);else{for(var v=new Array(p.argsNum),f=0,m=v.length;f<m;++f)v[f]=arguments[f+1];p.call.apply(void 0,v)}return!0}return!1}function h(e,t,n,i,d,y){var p=this.events[e],v;if(p!==void 0){if(p.length===0)return!1;if(p.argsNum<6)p.call(t,n,i,d,y);else{v=new Array(p.argsNum);for(var f=0,m=v.length;f<m;++f)v[f]=arguments[f+1];p.call.apply(void 0,v)}}var k=this.onceEvents[e];if(k){if(typeof k=="function")if(this.onceEvents[e]=void 0,arguments.length<6)k(t,n,i,d,y);else{if(v===void 0){v=new Array(arguments.length-1);for(var f=0,m=v.length;f<m;++f)v[f]=arguments[f+1]}k.apply(void 0,v)}else{var L=k;if(this.onceEvents[e]=void 0,arguments.length<6)for(var f=0;f<L.length;++f)L[f](t,n,i,d,y);else{if(v===void 0){v=new Array(arguments.length-1);for(var f=0,m=v.length;f<m;++f)v[f]=arguments[f+1]}for(var f=0;f<L.length;++f)L[f].apply(void 0,v)}}return!0}return p!==void 0}var s=function(){function e(){this.events=(0,u.nullObj)(),this.onceEvents=(0,u.nullObj)(),this._symbolKeys=new Set,this.maxListeners=1/0}return Object.defineProperty(e.prototype,"_eventsCount",{get:function(){return this.eventNames().length},enumerable:!1,configurable:!0}),e}();ee.EventEmitter=s;function _(e,t){switch(this.emit===r&&(this.emit=h),typeof this.onceEvents[e]){case"undefined":this.onceEvents[e]=t,typeof e=="symbol"&&this._symbolKeys.add(e);break;case"function":this.onceEvents[e]=[this.onceEvents[e],t];break;case"object":this.onceEvents[e].push(t)}return this}function E(e,t,n){if(n===void 0&&(n=t.length),typeof t!="function")throw new TypeError("The listener must be a function");var i=this.events[e];return i?(i.push(t),i.growArgsNum(n),this.maxListeners!==1/0&&this.maxListeners<=i.length&&console.warn('Maximum event listeners for "'.concat(String(e),'" event!'))):(this.events[e]=new a.TaskCollection(n,!0,t,!1),typeof e=="symbol"&&this._symbolKeys.add(e)),this}function A(e,t){var n=this.events[e];n&&n.removeLast(t);var i=this.onceEvents[e];return i&&(typeof i=="function"?this.onceEvents[e]=void 0:typeof i=="object"&&(i.length===1&&i[0]===t?this.onceEvents[e]=void 0:(0,l._fast_remove_single)(i,i.lastIndexOf(t)))),this}function O(e,t,n,i){n===void 0&&(n=this),i===void 0&&(i=t.length),this.boundFuncs||(this.boundFuncs=new Map);var d=t.bind(n);return this.boundFuncs.set(t,d),this.addListener(e,d,i)}function b(e,t){var n,i,d=(n=this.boundFuncs)===null||n===void 0?void 0:n.get(t);return(i=this.boundFuncs)===null||i===void 0||i.delete(t),this.removeListener(e,d)}function C(e){return this.events[e]&&!!this.events[e].length}function F(e,t,n){if(n===void 0&&(n=t.length),typeof t!="function")throw new TypeError("The listener must be a function");var i=this.events[e];return!i||!(i instanceof a.TaskCollection)?(i=this.events[e]=new a.TaskCollection(n,!0,t,!1),typeof e=="symbol"&&this._symbolKeys.add(e)):(i.insert(0,t),i.growArgsNum(n),this.maxListeners!==1/0&&this.maxListeners<=i.length&&console.warn('Maximum event listeners for "'.concat(String(e),'" event!'))),this}function q(e,t){this.emit===r&&(this.emit=h);var n=this.onceEvents[e];return n?typeof n!="object"?(this.onceEvents[e]=[t,n],typeof e=="symbol"&&this._symbolKeys.add(e)):(n.unshift(t),this.maxListeners!==1/0&&this.maxListeners<=n.length&&console.warn('Maximum event listeners for "'.concat(String(e),'" once event!'))):(this.onceEvents[e]=[t],typeof e=="symbol"&&this._symbolKeys.add(e)),this}function B(e){return e===void 0?(this.events=(0,u.nullObj)(),this.onceEvents=(0,u.nullObj)(),this._symbolKeys=new Set):(this.events[e]=void 0,this.onceEvents[e]=void 0,typeof e=="symbol"&&this._symbolKeys.delete(e)),this}function D(e){return this.maxListeners=e,this}function P(){return this.maxListeners}function j(e){return this.emit===r?this.events[e]?this.events[e].tasksAsArray().slice():[]:this.events[e]&&this.onceEvents[e]?c(c([],this.events[e].tasksAsArray(),!0),typeof this.onceEvents[e]=="function"?[this.onceEvents[e]]:this.onceEvents[e],!0):this.events[e]?this.events[e].tasksAsArray():this.onceEvents[e]?typeof this.onceEvents[e]=="function"?[this.onceEvents[e]]:this.onceEvents[e]:[]}function o(){var e=this;if(this.emit===r){var t=Object.keys(this.events);return c(c([],t,!0),Array.from(this._symbolKeys),!0).filter(function(i){return i in e.events&&e.events[i]&&e.events[i].length})}else{var t=Object.keys(this.events).filter(function(d){return e.events[d]&&e.events[d].length}),n=Object.keys(this.onceEvents).filter(function(d){return e.onceEvents[d]&&e.onceEvents[d].length});return c(c(c([],t,!0),n,!0),Array.from(this._symbolKeys).filter(function(d){return d in e.events&&e.events[d]&&e.events[d].length||d in e.onceEvents&&e.onceEvents[d]&&e.onceEvents[d].length}),!0)}}function g(e){return this.emit===r?this.events[e]&&this.events[e].length||0:(this.events[e]&&this.events[e].length||0)+(this.onceEvents[e]&&this.onceEvents[e].length||0)}return s.prototype.emit=r,s.prototype.on=E,s.prototype.once=_,s.prototype.addListener=E,s.prototype.removeListener=A,s.prototype.addListenerBound=O,s.prototype.removeListenerBound=b,s.prototype.hasListeners=C,s.prototype.prependListener=F,s.prototype.prependOnceListener=q,s.prototype.off=A,s.prototype.removeAllListeners=B,s.prototype.setMaxListeners=D,s.prototype.getMaxListeners=P,s.prototype.listeners=j,s.prototype.eventNames=o,s.prototype.listenerCount=g,ee}var hasRequiredLib;function requireLib(){return hasRequiredLib||(hasRequiredLib=1,function(c){var a=lib.__createBinding||(Object.create?function(u,r,h,s){s===void 0&&(s=h);var _=Object.getOwnPropertyDescriptor(r,h);(!_||("get"in _?!r.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return r[h]}}),Object.defineProperty(u,s,_)}:function(u,r,h,s){s===void 0&&(s=h),u[s]=r[h]}),l=lib.__exportStar||function(u,r){for(var h in u)h!=="default"&&!Object.prototype.hasOwnProperty.call(r,h)&&a(r,u,h)};Object.defineProperty(c,"__esModule",{value:!0}),l(requireTypes(),c),l(requireEe(),c)}(lib)),lib}var libExports=requireLib();export{libExports as l};
